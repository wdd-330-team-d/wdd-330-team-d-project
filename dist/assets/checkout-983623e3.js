import{g as a,s as n,r as l,a as u,q as c,l as m}from"./utils-e2829c12.js";import{c as h}from"./externalServices-db2f91cb.js";function d(t){const e=new FormData(t),o={};return e.forEach(function(s,i){o[i]=s}),o}function p(t){return t.map(o=>(console.log(o),{id:o.Id,price:o.FinalPrice,name:o.Name,quantity:1}))}const r={key:"",outputSelector:"",list:[],itemTotal:0,shipping:0,tax:0,orderTotal:0,init:function(t,e){this.key=t,this.outputSelector=e,this.list=a(t),this.calculateItemSummary()},calculateItemSummary:function(){const t=document.querySelector(this.outputSelector+" #cartTotal"),e=document.querySelector(this.outputSelector+" #num-items");e.innerText=this.list.length;const o=this.list.map(s=>s.FinalPrice);this.itemTotal=o.reduce((s,i)=>s+i),t.innerText="$"+this.itemTotal.toFixed(2)},calculateOrdertotal:function(){this.shipping=10+(this.list.length-1)*2,this.tax=(this.itemTotal*.06).toFixed(2),this.orderTotal=(parseFloat(this.itemTotal)+parseFloat(this.shipping)+parseFloat(this.tax)).toFixed(2),this.displayOrderTotals()},displayOrderTotals:function(){const t=document.querySelector(this.outputSelector+" #shipping"),e=document.querySelector(this.outputSelector+" #tax"),o=document.querySelector(this.outputSelector+" #orderTotal");t.innerText="$"+this.shipping,e.innerText="$"+this.tax,o.innerText="$"+this.orderTotal},checkout:async function(t){const e=d(t);e.orderDate=new Date,e.orderTotal=this.orderTotal,e.tax=this.tax,e.shipping=this.shipping,e.items=p(this.list),console.log(e);try{const o=await h(e);console.log(o),n("so-cart",[]),location.assign("/checkout/success.html")}catch(o){l();for(let s in o.message)u(o.message[s]);console.log(o)}}},f=c("#main-header"),g=c("footer");m(f,g);r.init("so-cart",".checkout-summary");document.querySelector("#zip").addEventListener("blur",r.calculateOrdertotal.bind(r));document.forms.checkout.addEventListener("submit",t=>{t.preventDefault(),r.checkout(t.target)});document.querySelector("#checkoutSubmit").addEventListener("click",t=>{t.preventDefault();var e=document.forms[0],o=e.checkValidity();e.reportValidity(),o&&r.checkout()});document.querySelector("#checkoutSubmit").addEventListener("click",t=>{t.preventDefault(),r.checkout(document.forms.checkout)});
